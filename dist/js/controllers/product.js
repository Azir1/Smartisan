"use strict";$(function(){$(".navbar .list li").eq(0).click(function(){location.href="./index.html"});var n=location.href.split("?")[1];n||(alert("非法访问"),location.href="./index.html");var u=n.split("=")[1];$.ajax({type:"post",url:"/product",data:{id:u},dataType:"json",success:function(n){var a=n.data,i=$('\n            <ul class="img-list">\n                \n            </ul>\n            <div class="bigimg">\n                \n            </div>\n            <ul class="info">\n                <li>\n                    <p>'+a.name+"</p>\n                    <p>\n                        <span>"+a.introduce+"</span>\n                        <span>"+a.price+'</span>\n                    </p>\n                </li>\n                <li>\n                    <h4>分辨率</h4>\n                    <span>1080P</span>\n                </li>\n                <li>\n                    <h4>颜色选择</h4>\n                    <span>白色</span>\n                    <span>黑色</span>\n                </li>\n                <li>\n                    <h4>数量选择</h4>\n                    <div>\n                        <span class="reduce"></span>\n                        <span class="num">1</span>\n                        <span class="plus"></span>\n                    </div>\n                </li>\n                <li>\n                    <h4>服务说明</h4>\n                    <i>*'+a.explain+"</i>\n                </li>\n            </ul>\n            ");$("section .wrap").prepend(i);var t=a.smallImg;if(t){var s=(t=t.split("====")).length,l=$("\n                        <img src="+t[0]+' alt="">\n                    ');$(".bigimg").append(l);for(var e=0;e<s;e++){var r=$("\n                        <li>\n                            <img src="+t[e]+' alt="">\n                        </li>\n                    ');0===e&&r.addClass("active"),$(".img-list").append(r)}$(".img-list li").click(function(){$(this).siblings().removeClass("active"),$(this).addClass("active"),console.log(),console.log(),$(this).parent().next().children().prop("src",$(this).children().prop("src"))})}var p=$("\n                <li>\n                    <img src="+a.bigImg+' alt="" style="width: 960px">\n                </li>\n            ');$(".card ul").append(p);var c=$('\n            <div class="wrap">\n                <div>\n                    您已选择了\n                    <div>\n                        <p>&nbsp; '+a.name+"\n                            &nbsp;</p>\n                        <p>"+a.introduce+'</p>\n                    </div><i>×</i><span>1</span>\n                </div>\n                <div>\n                    <p class="price">'+a.price+"</p>\n                    <button class='btn btn-default'>现在购买</button>\n                    <button class=\"addCart btn btn-default\">加入购物车</button>\n                </div>\n            </div>\n                ");$(".bottom").append(c);var o=+$(".plus").prev().text();$(".plus").click(function(){++o>=a.surplus&&(o=a.surplus),$(this).prev().text(o),$(".bottom span").text(o)}),$(".reduce").click(function(){--o<=1&&(o=1),$(this).next().text(o),$(".bottom span").text(o)});var d=getCookie("username");$(".addCart").prev().click(function(){if(!d)return alert("请先登录"),!(location.href="./login.html");var n=layer.load(1,{shade:[.1,"#fff"]});setTimeout(function(){layer.close(n),location.href="./shoppingcart.html"},500)}),$(".addCart").click(function(){if(!d)return alert("请先登录"),!(location.href="./login.html");var n=localStorage.getItem("data"),a=+$(".plus").prev().text();if(n){var i=JSON.parse(n),t=i.findIndex(function(n){return n.id==u});if(-1==t){l={username:d,id:u,num:a};i.push(l)}else i[t].num+=a;localStorage.setItem("data",JSON.stringify(i))}else{var s=[],l={username:d,id:u,num:a};s.push(l);var e=JSON.stringify(s);localStorage.setItem("data",e)}layer.msg("添加成功")})}})});